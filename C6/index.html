<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Math Adventure ‚Äî Length, Mass & Volume (Kids)</title>
<style>
  :root{
    --bg-grad: linear-gradient(135deg,#fffae6 0%, #d7f8ff 100%);
    --card:#ffffff;
    --accent:#FF6B6B;
    --accent2:#4ECAD4;
    --accent3:#FFD166;
    --ok:#4caf50;
    --bad:#f44336;
    --shadow: 0 8px 20px rgba(10,20,40,0.12);
    --radius: 14px;
  }
  html,body{height:100%;margin:0;font-family: "Comic Sans MS", "Poppins", Arial, sans-serif;background:var(--bg-grad);display:flex;align-items:center;justify-content:center}
  .wrap{width:980px;max-width:96%;padding:22px}
  header{display:flex;align-items:center;gap:16px;margin-bottom:12px}
  header .logo{width:72px;height:72px;border-radius:18px;background:linear-gradient(135deg,var(--accent),#ff8e53);display:flex;align-items:center;justify-content:center;color:white;font-weight:800;font-size:28px;box-shadow:var(--shadow)}
  header h1{margin:0;color:#1b3b4a;font-size:28px}
  .top-row{display:flex;gap:12px;align-items:center;justify-content:space-between;margin-bottom:18px}
  .panel{background:var(--card);border-radius:var(--radius);box-shadow:var(--shadow);padding:14px;display:flex;align-items:center;gap:12px}
  .stats{display:flex;gap:8px;align-items:center}
  .stat{background:linear-gradient(90deg,#fff,#f6f6f6);padding:8px 12px;border-radius:10px;min-width:110px;text-align:center}
  .stat .label{font-size:12px;color:#666}
  .stat .val{font-size:20px;font-weight:700;color:#1b3b4a}
  .controls{display:flex;gap:8px;align-items:center}
  .topic-btn{padding:10px 14px;border-radius:12px;border:none;background:linear-gradient(90deg,var(--accent2),#7de0c6);color:#063;cursor:pointer;font-weight:700;box-shadow:0 6px 14px rgba(0,0,0,0.08)}
  .topic-btn.active{outline:4px solid rgba(255,123,98,0.12);transform:translateY(-4px)}
  .game-area{margin-top:16px;background:var(--card);border-radius:18px;padding:20px;box-shadow:var(--shadow);display:flex;gap:18px;align-items:flex-start}
  .left{flex:1;min-width:300px}
  .right{width:320px}
  .card{background:linear-gradient(180deg,#ffffff,#fbfbfd);border-radius:12px;padding:14px;box-shadow:0 6px 18px rgba(0,0,0,0.06)}
  .question {font-size:22px;font-weight:800;color:#123; margin:8px 0 14px}
  .visual {height:130px;display:flex;align-items:center;justify-content:center;gap:12px}
  /* options */
  .options{display:grid;grid-template-columns:1fr 1fr;gap:10px}
  .opt{background:#f2fbff;border-radius:10px;padding:12px;font-size:18px;font-weight:700;color:#083545;cursor:pointer;display:flex;align-items:center;justify-content:center;border:3px solid transparent;transition:all .22s}
  .opt:hover{transform:translateY(-4px);box-shadow:0 8px 18px rgba(2,18,28,0.06)}
  .opt.correct{background:linear-gradient(90deg,#dff7dd,#b6f7b0);border-color:rgba(76,175,80,0.22)}
  .opt.wrong{background:linear-gradient(90deg,#ffddd7,#ffb3b3);border-color:rgba(244,67,54,0.18)}
  /* lives / timer */
  .small{font-size:13px;color:#666}
  .lives{display:flex;gap:6px;align-items:center}
  .heart{width:28px;height:28px;border-radius:8px;background:linear-gradient(180deg,#ff7e92,#ff4b6b);display:inline-flex;align-items:center;justify-content:center;color:white;font-weight:800;box-shadow:0 6px 12px rgba(255,80,120,0.18)}
  .timerbar{height:10px;background:#e6f7ff;border-radius:8px;overflow:hidden;margin-top:8px}
  .timerfill{height:100%;background:linear-gradient(90deg,#FFD166,#FF6B6B);width:100%}
  /* right column */
  .score-large{font-size:26px;font-weight:900;color:#063}
  .play-btn{margin-top:10px;padding:12px 18px;border-radius:12px;border:none;background:linear-gradient(90deg,#FF6B6B,#fe8e53);color:white;font-weight:900;cursor:pointer;box-shadow:0 12px 30px rgba(255,100,100,0.12)}
  .play-btn.secondary{background:linear-gradient(90deg,#4ECAD4,#60e0d8);color:#053}
  .feedback{height:56px;border-radius:10px;display:flex;align-items:center;justify-content:center;font-weight:900;font-size:16px}
  .feedback.ok{background:linear-gradient(90deg,#dff7dd,#b6f7b0);color:#2a6b2a}
  .feedback.bad{background:linear-gradient(90deg,#ffdede,#ffb3b3);color:#9a2b2b}
  /* game over modal */
  .overlay{position:fixed;inset:0;background:rgba(3,18,28,0.45);display:flex;align-items:center;justify-content:center;z-index:1000;visibility:hidden;opacity:0;transition:all .2s}
  .overlay.show{visibility:visible;opacity:1}
  .modal{background:white;padding:24px;border-radius:14px;max-width:420px;text-align:center;box-shadow:0 12px 40px rgba(0,0,0,0.4)}
  .confetti-canvas{position:fixed;left:0;top:0;pointer-events:none;z-index:2000}
  /* responsive */
  @media (max-width:880px){ .game-area{flex-direction:column} .right{width:100%} .options{grid-template-columns:1fr} header{flex-direction:column;align-items:flex-start} }
</style>
</head>
<body>
<div class="wrap">
  <header>
    <div class="logo">MA</div>
    <div>
      <h1>Math Adventure</h1>
      <div style="color:#446;color:rgba(0,0,0,0.45)">Length ‚Ä¢ Mass ‚Ä¢ Volume ‚Äî Fun practice for Standard 3</div>
    </div>
  </header>

  <div class="top-row">
    <div class="panel stats">
      <div class="stat"><div class="label">Score</div><div id="score" class="val">0</div></div>
      <div class="stat"><div class="label">Lives</div><div id="lives" class="val">3</div></div>
      <div class="stat"><div class="label">Topic</div><div id="topicLabel" class="val">Length</div></div>
    </div>

    <div class="panel controls">
      <button class="topic-btn active" data-topic="length">üìè Length</button>
      <button class="topic-btn" data-topic="mass">‚öñÔ∏è Mass</button>
      <button class="topic-btn" data-topic="volume">üß™ Volume</button>
      <label style="margin-left:10px;font-size:13px;color:#444" title="Toggle a 20s timer per question">
        <input type="checkbox" id="toggleTimer"> Timer
      </label>
    </div>
  </div>

  <div class="game-area">
    <div class="left">
      <div class="card">
        <div class="question" id="questionText">Welcome to Math Adventure! Choose a topic and press Play.</div>
        <div class="visual" id="visualArea">
          <!-- simple visual representation -->
          <div style="font-size:64px;opacity:.9">üéØ</div>
        </div>

        <div class="options" id="optionsWrap">
          <!-- options injected here -->
        </div>

        <div style="display:flex;align-items:center;justify-content:space-between;margin-top:14px">
          <div>
            <div class="small">Time</div>
            <div class="timerbar" id="timerBar" style="display:none"><div class="timerfill" id="timerFill"></div></div>
          </div>
          <div style="flex:1"></div>
          <div style="text-align:right">
            <div class="small">Feedback</div>
            <div id="feedback" class="feedback" style="background:#fff">Ready!</div>
          </div>
        </div>
      </div>

    </div>

    <div class="right">
      <div class="card" style="text-align:center">
        <div style="font-size:14px;color:#666">Current Topic</div>
        <div id="topicBig" style="font-size:20px;font-weight:900;margin:6px 0;color:var(--accent)"></div>
        <div style="margin-top:8px"><button id="playBtn" class="play-btn">Play</button></div>
        <div style="margin-top:12px;color:#666;font-size:13px">Get +10 for each correct. Wrong = -1 life. Game over when lives reach 0.</div>
        <div style="margin-top:14px">
          <div style="font-size:13px;color:#666">Quick Controls</div>
          <button id="skipBtn" class="play-btn secondary" style="margin-top:8px">Skip (-1 life)</button>
        </div>
      </div>

      <div class="card" style="margin-top:14px;text-align:center">
        <div style="font-size:13px;color:#666">Scoreboard</div>
        <div style="font-size:28px;font-weight:900;color:#064;margin-top:8px" id="scoreDisplay">0</div>
        <div style="margin-top:10px">
          <button id="playAgain" class="play-btn" style="display:none">Play Again</button>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Game Over Modal -->
<div id="overlay" class="overlay">
  <div class="modal">
    <h2 id="modalTitle">Game Over</h2>
    <p id="modalText" style="font-weight:700;font-size:20px;margin:12px 0">Final score: 0</p>
    <div style="display:flex;gap:8px;justify-content:center;margin-top:8px">
      <button id="replay" class="play-btn">Play Again</button>
      <button id="toMenu" class="play-btn secondary">Back to Topic</button>
    </div>
  </div>
</div>

<canvas id="confetti" class="confetti-canvas"></canvas>

<script>
/* ---------- Game State ---------- */
let state = {
  topic: 'length', // length | mass | volume
  score: 0,
  lives: 3,
  timerOn: false,
  timeLeft: 20,
  currentAnswer: null,
  busy: false,
  questionCount: 0
};

/* ---------- Helpers ---------- */
const $ = (id)=>document.getElementById(id);
const rand = (min,max)=>Math.floor(Math.random()*(max-min+1))+min;
const shuffle = arr => arr.sort(()=>Math.random()-0.5);

/* ---------- UI Elements ---------- */
const topicBtns = document.querySelectorAll('.topic-btn');
const playBtn = $('playBtn'), skipBtn = $('skipBtn'), playAgainBtn = $('playAgain');
const questionText = $('questionText'), visualArea = $('visualArea'), optionsWrap = $('optionsWrap');
const feedback = $('feedback'), scoreEl = $('score'), livesEl = $('lives'), topicLabel = $('topicLabel'), topicBig = $('topicBig');
const overlay = $('overlay'), modalTitle = $('modalTitle'), modalText = $('modalText');
const toggleTimer = $('toggleTimer'), timerBar = $('timerBar'), timerFill = $('timerFill'), timerBarWrap = $('timerBar');
const scoreDisplay = $('scoreDisplay'), replay = $('replay'), toMenu = $('toMenu');

let timerInterval = null;

/* ---------- Confetti (simple) ---------- */
const confettiCanvas = $('confetti');
const confettiCtx = confettiCanvas.getContext('2d');
let confettis = [];
function resizeCanvas(){ confettiCanvas.width = window.innerWidth; confettiCanvas.height = window.innerHeight; }
window.addEventListener('resize',resizeCanvas); resizeCanvas();
function spawnConfetti(){
  confettis = [];
  for(let i=0;i<120;i++){
    confettis.push({
      x: Math.random()*confettiCanvas.width,
      y: Math.random()*-confettiCanvas.height,
      vx: (Math.random()-0.5)*6,
      vy: Math.random()*6+2,
      r: Math.random()*6+4,
      color: ['#FF6B6B','#FFD166','#4ECAD4','#8ec5ff'][Math.floor(Math.random()*4)]
    });
  }
  let frames=0;
  function frame(){
    frames++; confettiCtx.clearRect(0,0,confettiCanvas.width,confettiCanvas.height);
    confettis.forEach(c=>{
      c.x += c.vx; c.y += c.vy; c.vy += 0.06;
      confettiCtx.fillStyle = c.color; confettiCtx.fillRect(c.x,c.y,c.r, c.r*0.6);
    });
    if(frames<200) requestAnimationFrame(frame);
    else confettiCtx.clearRect(0,0,confettiCanvas.width,confettiCanvas.height);
  }
  frame();
}

/* ---------- Topic Buttons ---------- */
topicBtns.forEach(btn=>{
  btn.addEventListener('click', ()=>{
    topicBtns.forEach(b=>b.classList.remove('active'));
    btn.classList.add('active');
    state.topic = btn.dataset.topic;
    $('topicLabel').innerText = state.topic.charAt(0).toUpperCase()+state.topic.slice(1);
    $('topicBig').innerText = state.topic.toUpperCase();
    resetRound();
  });
});

/* ---------- Toggle Timer ---------- */
toggleTimer.addEventListener('change', ()=>{
  state.timerOn = toggleTimer.checked;
  timerBar.style.display = state.timerOn ? 'block' : 'none';
});

/* ---------- Start / Skip / Play Again ---------- */
playBtn.addEventListener('click', ()=>startGame());
skipBtn.addEventListener('click', ()=>{ loseLife(); nextQuestion(); });
playAgainBtn.addEventListener('click', ()=>startGame());
replay.addEventListener('click', ()=>{ overlay.classList.remove('show'); startGame(); });
toMenu.addEventListener('click', ()=>{ overlay.classList.remove('show'); resetRound(); });

/* ---------- Start or Reset ---------- */
function resetRound(){
  state.score = 0; state.lives = 3; state.questionCount=0; updateUI();
  questionText.innerText = 'Press Play to start the challenge!';
  visualArea.innerHTML = '<div style="font-size:64px">üéØ</div>';
  optionsWrap.innerHTML = '';
  feedback.innerText = 'Ready!';
  feedback.className = 'feedback';
  $('playAgain').style.display = 'none';
  stopTimer();
}

function startGame(){
  state.score = 0; state.lives = 3; state.questionCount=0; state.busy = false;
  updateUI();
  $('playAgain').style.display = 'none';
  nextQuestion();
}

/* ---------- Timer ---------- */
function startTimer(seconds=20){
  stopTimer();
  if(!state.timerOn) return;
  state.timeLeft = seconds;
  timerBar.style.display = 'block';
  timerFill.style.width = '100%';
  timerInterval = setInterval(()=>{
    state.timeLeft--;
    const pct = Math.max(0, state.timeLeft/seconds)*100;
    timerFill.style.width = pct + '%';
    if(state.timeLeft<=0){ stopTimer(); // time up -> lose life and next
      feedbackBad('Time up! -1 life'); loseLife(); setTimeout(()=>nextQuestion(),800);
    }
  },1000);
}
function stopTimer(){ if(timerInterval){ clearInterval(timerInterval); timerInterval=null; } timerBar.style.display = state.timerOn ? 'block' : 'none'; timerFill.style.width='100%'; }

/* ---------- UI update ---------- */
function updateUI(){
  scoreEl.innerText = state.score;
  livesEl.innerText = state.lives;
  scoreDisplay.innerText = state.score;
  topicLabel.innerText = state.topic.charAt(0).toUpperCase()+state.topic.slice(1);
  topicBig.innerText = state.topic.toUpperCase();
}

/* ---------- Show Feedback ---------- */
function feedbackOk(msg){
  feedback.innerText = msg; feedback.className = 'feedback ok';
}
function feedbackBad(msg){
  feedback.innerText = msg; feedback.className = 'feedback bad';
}

/* ---------- Generate Questions ---------- */
function nextQuestion(){
  if(state.lives<=0){ gameOver(); return; }
  state.busy = false;
  stopTimer();
  state.questionCount++;
  const t = state.topic;
  if(t==='length') generateLength();
  else if(t==='mass') generateMass();
  else generateVolume();
}

/* ---------- Length: cm -> m ---------- */
function generateLength(){
  const cm = rand(20,240); // 20cm - 240cm (0.20m - 2.40m)
  const correct = (cm/100).toFixed(2); // m with 2 decimals (e.g., 1.20)
  const opts = new Set([correct]);
  while(opts.size<4){
    // plausible wrong: +/- 0.1 or 0.2 or rounding differences
    const offset = [0.10,0.20,-0.10,-0.20,0.05,-0.05][rand(0,5)];
    const val = (parseFloat(correct)+offset).toFixed(2);
    opts.add(val);
  }
  showQuestion(`${cm} cm = ? m`, createRulerVisual(cm,'cm'), Array.from(shuffle(Array.from(opts))), correct, 20);
}

/* ---------- Mass: g -> kg ---------- */
function generateMass(){
  const g = rand(120,980); // 120g - 980g
  const correct = (g/1000).toFixed(3); // e.g., 0.120
  const opts = new Set([correct]);
  while(opts.size<4){
    const offset = [0.100,0.200,-0.100,0.050,-0.050][rand(0,4)];
    const val = (parseFloat(correct)+offset).toFixed(3);
    opts.add(val);
  }
  showQuestion(`${g} g = ? kg`, createMassVisual(g), Array.from(shuffle(Array.from(opts))), correct, 20);
}

/* ---------- Volume: ml -> L ---------- */
function generateVolume(){
  const ml = rand(150,950); // 150ml - 950ml
  const correct = (ml/1000).toFixed(3); // e.g., 0.150
  const opts = new Set([correct]);
  while(opts.size<4){
    const offset = [0.100,0.200,-0.100,0.050,-0.050][rand(0,4)];
    const val = (parseFloat(correct)+offset).toFixed(3);
    opts.add(val);
  }
  showQuestion(`${ml} ml = ? L`, createBeakerVisual(ml), Array.from(shuffle(Array.from(opts))), correct, 20);
}

/* ---------- Visual helpers ---------- */
function createRulerVisual(cm, unit){
  const pxPerCm = 1.6; // visual scale
  const width = Math.min(420, Math.round(cm * pxPerCm + 60));
  const outer = document.createElement('div');
  outer.style.width = width + 'px';
  outer.style.padding = '10px';
  outer.style.borderRadius = '10px';
  outer.style.background = 'linear-gradient(90deg,#fff7e6,#fff)';
  outer.style.display='flex'; outer.style.flexDirection='column'; outer.style.alignItems='center';
  const bar = document.createElement('div');
  bar.style.width = '100%'; bar.style.height = '18px'; bar.style.background = '#eee'; bar.style.borderRadius='8px';
  bar.style.position='relative';
  const tickCount = Math.min(30, Math.ceil(cm/1));
  for(let i=0;i<=tickCount;i+= Math.max(1, Math.round(tickCount/10))){
    const mark = document.createElement('div');
    mark.style.position='absolute'; mark.style.left = (i/tickCount*100) + '%'; mark.style.top='-8px'; mark.style.transform='translateX(-50%)';
    mark.style.fontSize='12px'; mark.style.color='#444'; mark.innerText = Math.round(i*(cm/tickCount));
    bar.appendChild(mark);
  }
  const obj = document.createElement('div'); obj.style.marginTop='12px'; obj.style.fontSize='20px'; obj.innerText = `${cm} ${unit}`;
  outer.appendChild(bar); outer.appendChild(obj);
  return outer;
}
function createMassVisual(g){
  const outer = document.createElement('div');
  outer.style.display='flex'; outer.style.alignItems='center'; outer.style.flexDirection='column';
  outer.innerHTML = `<div style="font-size:48px">‚öñÔ∏è</div><div style="margin-top:6px;font-weight:800">${g} g</div>`;
  return outer;
}
function createBeakerVisual(ml){
  const outer = document.createElement('div');
  outer.style.display='flex'; outer.style.alignItems='center'; outer.style.flexDirection='column';
  const heightPct = Math.round((ml/1000)*100);
  const beaker = document.createElement('div');
  beaker.style.width='72px'; beaker.style.height='120px'; beaker.style.border='3px solid #cde'; beaker.style.borderRadius='6px';
  beaker.style.position='relative'; beaker.style.overflow='hidden'; beaker.style.background='#fff';
  const liquid = document.createElement('div');
  liquid.style.position='absolute'; liquid.style.left='0'; liquid.style.right='0'; liquid.style.bottom='0';
  liquid.style.height = Math.min(100,Math.max(8,heightPct)) + '%'; liquid.style.background = 'linear-gradient(180deg,#4ECAD4,#1fbdae)'; 
  beaker.appendChild(liquid);
  outer.appendChild(beaker);
  outer.appendChild(Object.assign(document.createElement('div'),{innerText: ml+' ml', style:'margin-top:8px;font-weight:800'}));
  return outer;
}

/* ---------- Display question ---------- */
function showQuestion(qText, visualEl, options, correct, questionSeconds=20){
  questionText.innerText = qText;
  visualArea.innerHTML = ''; visualArea.appendChild(visualEl);
  optionsWrap.innerHTML = '';
  state.currentAnswer = correct;
  state.busy = false;
  options.forEach(opt=>{
    const b = document.createElement('div');
    b.className = 'opt'; b.innerText = opt;
    b.onclick = ()=>{ if(state.busy) return; handleChoice(b,opt); };
    optionsWrap.appendChild(b);
  });
  feedback.innerText = 'Choose an answer!';
  feedback.className = 'feedback';
  updateUI();
  if(state.timerOn) startTimer(questionSeconds);
  else stopTimer();
}

/* ---------- Handle Choice ---------- */
function handleChoice(buttonElem, chosen){
  state.busy = true;
  stopTimer();
  if(chosen === state.currentAnswer){
    buttonElem.classList.add('correct');
    state.score += 10;
    updateUI();
    feedbackOk(['Great!','Awesome!','Well done!','Nice!'][rand(0,3)]);
    spawnConfetti();
    setTimeout(()=> nextQuestion(), 900);
  } else {
    buttonElem.classList.add('wrong');
    // highlight correct
    Array.from(document.querySelectorAll('.opt')).forEach(o=>{
      if(o.innerText === state.currentAnswer) o.classList.add('correct');
    });
    feedbackBad('Oops! -1 life');
    loseLife();
    setTimeout(()=> nextQuestion(), 900);
  }
}

/* ---------- Lose life ---------- */
function loseLife(){
  state.lives = Math.max(0, state.lives-1);
  updateUI();
  if(state.lives<=0){ setTimeout(()=>gameOver(), 700); }
}

/* ---------- Game over ---------- */
function gameOver(){
  stopTimer();
  overlay.classList.add('show');
  modalTitle.innerText = 'Game Over';
  modalText.innerText = `Final score: ${state.score}`;
  $('playAgain').style.display = 'inline-block';
}

/* ---------- initial states ---------- */
resetRound();

/* ---------- keyboard shortcuts for quick testing ---------- */
document.addEventListener('keydown',(e)=>{
  if(e.key==='1') { document.querySelector('[data-topic="length"]').click(); }
  if(e.key==='2') { document.querySelector('[data-topic="mass"]').click(); }
  if(e.key==='3') { document.querySelector('[data-topic="volume"]').click(); }
  if(e.key===' ') { playBtn.click(); }
});
</script>
</body>
</html>
