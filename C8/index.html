<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Math Adventure: Location Explorer</title>
    <style>
        /* Reset and Base Styles */
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Comic Sans MS', 'Chalkboard SE', cursive;
        }
        
        body {
            background: linear-gradient(135deg, #74b9ff 0%, #0984e3 100%);
            color: #2d3436;
            min-height: 100vh;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        .container {
            max-width: 900px;
            width: 100%;
            background: white;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            padding: 25px;
            margin: 15px 0;
        }
        
        h1 {
            color: #d63031;
            text-align: center;
            margin-bottom: 10px;
            font-size: 2.8rem;
            text-shadow: 2px 2px 0 #ffeaa7;
        }
        
        .subtitle {
            text-align: center;
            color: #0984e3;
            margin-bottom: 25px;
            font-size: 1.3rem;
            font-weight: bold;
        }
        
        /* Game Selector */
        .game-selector {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }
        
        .game-btn {
            background: #00b894;
            color: white;
            border: none;
            border-radius: 50px;
            padding: 12px 25px;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 0 #00a085;
        }
        
        .game-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 0 #00a085;
        }
        
        .game-btn.active {
            background: #e17055;
            box-shadow: 0 4px 0 #d63031;
        }
        
        /* Game Area */
        .game-area {
            background: #f7f7f7;
            border-radius: 15px;
            padding: 25px;
            min-height: 500px;
            border: 3px solid #74b9ff;
        }
        
        .game-title {
            color: #e17055;
            text-align: center;
            margin-bottom: 20px;
            font-size: 2rem;
            text-shadow: 1px 1px 0 #ffeaa7;
        }
        
        /* Mission Control */
        .mission-control {
            background: #ffeaa7;
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 20px;
            border: 3px dashed #fdcb6e;
            text-align: center;
        }
        
        .mission-text {
            font-size: 1.4rem;
            color: #d63031;
            margin-bottom: 10px;
            font-weight: bold;
        }
        
        .mission-objective {
            font-size: 1.2rem;
            color: #2d3436;
        }
        
        /* Map Container - SIMPLIFIED */
        .map-container {
            position: relative;
            width: 100%;
            max-width: 500px;
            height: 350px;
            background: #dfe6e9;
            border: 4px solid #2d3436;
            border-radius: 10px;
            margin: 0 auto 20px;
            overflow: hidden;
        }
        
        .grid-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                linear-gradient(to right, #b2bec3 1px, transparent 1px),
                linear-gradient(to bottom, #b2bec3 1px, transparent 1px);
            background-size: 50px 35px;
        }
        
        /* Clear Coordinate Labels */
        .coordinates {
            position: absolute;
            font-size: 0.9rem;
            font-weight: bold;
            color: #2d3436;
            background: rgba(255, 255, 255, 0.8);
            padding: 2px 5px;
            border-radius: 3px;
        }
        
        .x-coordinates {
            position: absolute;
            bottom: -25px;
            width: 100%;
            display: flex;
            justify-content: space-between;
            padding: 0 25px;
        }
        
        .y-coordinates {
            position: absolute;
            left: -25px;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            padding: 17px 0;
        }
        
        /* Simple Location Items */
        .location-item {
            position: absolute;
            width: 40px;
            height: 40px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            z-index: 10;
            transition: all 0.3s ease;
            border: 2px solid;
        }
        
        .location-item:hover {
            transform: scale(1.1);
        }
        
        .treasure {
            background: #fdcb6e;
            border-color: #e17055;
            box-shadow: 0 0 10px #fdcb6e;
            animation: bounce 2s infinite;
        }
        
        .landmark {
            background: #74b9ff;
            border-color: #0984e3;
        }
        
        .player {
            background: #00b894;
            border-color: #00a085;
        }
        
        .obstacle {
            background: #b2bec3;
            border-color: #636e72;
        }
        
        /* Navigation Controls */
        .navigation-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
            margin: 20px 0;
        }
        
        .compass {
            width: 120px;
            height: 120px;
            background: #dfe6e9;
            border-radius: 50%;
            position: relative;
            border: 3px solid #2d3436;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }
        
        .compass::before {
            content: "N";
            position: absolute;
            top: 5px;
            color: #d63031;
        }
        
        .compass::after {
            content: "‚Üë";
            position: absolute;
            font-size: 2rem;
        }
        
        .direction-controls {
            display: grid;
            grid-template-columns: repeat(3, 50px);
            grid-template-rows: repeat(3, 50px);
            gap: 8px;
        }
        
        .dir-btn {
            background: #74b9ff;
            border: 2px solid #0984e3;
            border-radius: 10px;
            color: white;
            font-size: 1.3rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }
        
        .dir-btn:hover {
            background: #0984e3;
        }
        
        .dir-btn:nth-child(1) { grid-column: 2; grid-row: 1; } /* Up */
        .dir-btn:nth-child(2) { grid-column: 1; grid-row: 2; } /* Left */
        .dir-btn:nth-child(3) { grid-column: 2; grid-row: 2; background: #0984e3; } /* Center */
        .dir-btn:nth-child(4) { grid-column: 3; grid-row: 2; } /* Right */
        .dir-btn:nth-child(5) { grid-column: 2; grid-row: 3; } /* Down */
        
        /* Input Controls */
        .coordinate-input {
            display: flex;
            gap: 10px;
            align-items: center;
            justify-content: center;
            margin: 20px 0;
            flex-wrap: wrap;
        }
        
        .coord-input {
            width: 60px;
            height: 40px;
            border: 2px solid #74b9ff;
            border-radius: 8px;
            text-align: center;
            font-size: 1.2rem;
            font-weight: bold;
        }
        
        .coord-label {
            font-size: 1.2rem;
            color: #0984e3;
            font-weight: bold;
        }
        
        /* Item Palette */
        .item-palette {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin: 20px 0;
            flex-wrap: wrap;
        }
        
        .palette-item {
            width: 50px;
            height: 50px;
            background: #dfe6e9;
            border: 2px solid #74b9ff;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            cursor: grab;
            transition: all 0.2s ease;
        }
        
        .palette-item:hover {
            background: #74b9ff;
            transform: scale(1.1);
        }
        
        /* Feedback */
        .feedback {
            margin-top: 20px;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            font-size: 1.2rem;
            font-weight: bold;
            min-height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .feedback.correct {
            background: #d4edda;
            color: #155724;
            border: 2px solid #c3e6cb;
        }
        
        .feedback.incorrect {
            background: #f8d7da;
            color: #721c24;
            border: 2px solid #f5c6cb;
        }
        
        /* Action Buttons */
        .action-btn {
            background: #e17055;
            color: white;
            border: none;
            border-radius: 25px;
            padding: 12px 30px;
            font-size: 1.2rem;
            font-weight: bold;
            cursor: pointer;
            margin-top: 15px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 0 #d63031;
        }
        
        .action-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 0 #d63031;
        }
        
        /* Score Container */
        .score-container {
            display: flex;
            justify-content: space-between;
            background: #ffeaa7;
            padding: 15px 25px;
            border-radius: 15px;
            margin-bottom: 20px;
            border: 3px solid #fdcb6e;
            font-weight: bold;
            font-size: 1.2rem;
        }
        
        .score-item {
            color: #d63031;
        }
        
        /* Animations */
        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        /* Responsive Design */
        @media (max-width: 600px) {
            .container {
                padding: 15px;
            }
            
            h1 {
                font-size: 2.2rem;
            }
            
            .game-btn {
                padding: 10px 20px;
                font-size: 1rem;
            }
            
            .map-container {
                height: 250px;
            }
            
            .grid-overlay {
                background-size: 35px 25px;
            }
            
            .coordinates {
                font-size: 0.8rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üìç Location Explorer</h1>
        <div class="subtitle">Learn Coordinates While Having Fun!</div>

        <div class="score-container">
            <div>Score: <span id="score" class="score-item">0</span></div>
            <div>Level: <span id="level" class="score-item">1</span></div>
            <div>Treasure Found: <span id="treasureFound" class="score-item">0</span></div>
        </div>

        <div class="game-selector">
            <button class="game-btn active" data-game="treasure">Treasure Hunt</button>
            <button class="game-btn" data-game="navigation">Navigation Game</button>
            <button class="game-btn" data-game="coordinates">Place the Items</button>
        </div>

        <div class="game-area">
            <!-- Treasure Hunt Game -->
            <div id="treasureGame" class="game-content">
                <h2 class="game-title">üß≠ Treasure Hunt</h2>
                
                <div class="mission-control">
                    <div class="mission-text">Find the Hidden Treasure!</div>
                    <div class="mission-objective" id="treasureObjective">The treasure is hidden at coordinates (X, Y)</div>
                </div>
                
                <div class="map-container" id="treasureMap">
                    <div class="grid-overlay"></div>
                    <div class="x-coordinates">
                        <span>1</span><span>2</span><span>3</span><span>4</span><span>5</span>
                        <span>6</span><span>7</span><span>8</span><span>9</span><span>10</span>
                    </div>
                    <div class="y-coordinates">
                        <span>1</span><span>2</span><span>3</span><span>4</span><span>5</span>
                        <span>6</span><span>7</span><span>8</span><span>9</span><span>10</span>
                    </div>
                </div>
                
                <div class="coordinate-input">
                    <span class="coord-label">X:</span>
                    <input type="number" class="coord-input" id="guessX" min="1" max="10" placeholder="1-10">
                    <span class="coord-label">Y:</span>
                    <input type="number" class="coord-input" id="guessY" min="1" max="10" placeholder="1-10">
                    <button class="action-btn" id="digTreasure">Dig Here!</button>
                </div>
                
                <div class="feedback" id="treasureFeedback">Click on the map or enter coordinates to find the treasure!</div>
            </div>
            
            <!-- Navigation Challenge Game -->
            <div id="navigationGame" class="game-content" style="display: none;">
                <h2 class="game-title">üß≠ Navigation Challenge</h2>
                
                <div class="mission-control">
                    <div class="mission-text">Reach the Destination!</div>
                    <div class="mission-objective" id="navObjective">Navigate from start to finish</div>
                </div>
                
                <div class="navigation-container">
                    <div class="map-container" id="navMap">
                        <div class="grid-overlay"></div>
                        <div class="x-coordinates">
                            <span>1</span><span>2</span><span>3</span><span>4</span><span>5</span>
                            <span>6</span><span>7</span><span>8</span><span>9</span><span>10</span>
                        </div>
                        <div class="y-coordinates">
                            <span>1</span><span>2</span><span>3</span><span>4</span><span>5</span>
                            <span>6</span><span>7</span><span>8</span><span>9</span><span>10</span>
                        </div>
                    </div>
                    
                    <div class="direction-controls">
                        <button class="dir-btn" data-direction="north">‚Üë</button>
                        <button class="dir-btn" data-direction="west">‚Üê</button>
                        <div class="dir-btn">‚óè</div>
                        <button class="dir-btn" data-direction="east">‚Üí</button>
                        <button class="dir-btn" data-direction="south">‚Üì</button>
                    </div>
                </div>
                
                <div class="feedback" id="navFeedback">Use the arrows to move around the map!</div>
                
                <button class="action-btn" id="checkNavigation">Check Position</button>
            </div>
            
            <!-- Coordinate Master Game -->
            <div id="coordinatesGame" class="game-content" style="display: none;">
                <h2 class="game-title">üìç Place the Items</h2>
                
                <div class="mission-control">
                    <div class="mission-text">Drag Items to Correct Coordinates!</div>
                    <div class="mission-objective" id="coordObjective">Place each item at its correct position</div>
                </div>
                
                <div class="map-container" id="coordMap">
                    <div class="grid-overlay"></div>
                    <div class="x-coordinates">
                        <span>1</span><span>2</span><span>3</span><span>4</span><span>5</span>
                        <span>6</span><span>7</span><span>8</span><span>9</span><span>10</span>
                    </div>
                    <div class="y-coordinates">
                        <span>1</span><span>2</span><span>3</span><span>4</span><span>5</span>
                        <span>6</span><span>7</span><span>8</span><span>9</span><span>10</span>
                    </div>
                </div>
                
                <div class="item-palette" id="itemPalette">
                    <!-- Items will be added here -->
                </div>
                
                <div class="feedback" id="coordFeedback">Drag items to their correct coordinates on the grid!</div>
                
                <button class="action-btn" id="checkCoordinates">Check Answers</button>
            </div>
        </div>
    </div>

    <script>
        // Game state
        let currentGame = 'treasure';
        let score = 0;
        let level = 1;
        let treasureFound = 0;
        let currentPosition = { x: 1, y: 1 };
        let targetPosition = {};
        let draggedItem = null;
        
        // DOM elements
        const gameBtns = document.querySelectorAll('.game-btn');
        const gameContents = document.querySelectorAll('.game-content');
        const scoreElement = document.getElementById('score');
        const levelElement = document.getElementById('level');
        const treasureFoundElement = document.getElementById('treasureFound');
        
        // Initialize the game
        function init() {
            // Set up game selector buttons
            gameBtns.forEach(btn => {
                btn.addEventListener('click', () => {
                    const game = btn.getAttribute('data-game');
                    switchGame(game);
                    
                    // Update active button
                    gameBtns.forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                });
            });
            
            // Set up games
            setupTreasureGame();
            setupNavigationGame();
            setupCoordinatesGame();
            
            // Start with treasure game
            switchGame('treasure');
        }
        
        // Switch between games
        function switchGame(game) {
            currentGame = game;
            
            // Hide all game contents
            gameContents.forEach(content => {
                content.style.display = 'none';
            });
            
            // Show selected game
            document.getElementById(`${game}Game`).style.display = 'block';
            
            // Generate new problem
            generateProblem();
        }
        
        // Generate a new problem based on current game
        function generateProblem() {
            if (currentGame === 'treasure') {
                generateTreasureProblem();
            } else if (currentGame === 'navigation') {
                generateNavigationProblem();
            } else if (currentGame === 'coordinates') {
                generateCoordinatesProblem();
            }
        }
        
        /* ----- TREASURE HUNT GAME ----- */
        function setupTreasureGame() {
            const treasureMap = document.getElementById('treasureMap');
            const digBtn = document.getElementById('digTreasure');
            
            // Click on map to guess coordinates
            treasureMap.addEventListener('click', (e) => {
                const rect = treasureMap.getBoundingClientRect();
                const x = Math.floor((e.clientX - rect.left) / (rect.width / 10)) + 1;
                const y = Math.floor((e.clientY - rect.top) / (rect.height / 10)) + 1;
                
                if (x >= 1 && x <= 10 && y >= 1 && y <= 10) {
                    document.getElementById('guessX').value = x;
                    document.getElementById('guessY').value = y;
                    checkTreasureGuess(x, y);
                }
            });
            
            // Dig button
            digBtn.addEventListener('click', () => {
                const x = parseInt(document.getElementById('guessX').value);
                const y = parseInt(document.getElementById('guessY').value);
                
                if (x >= 1 && x <= 10 && y >= 1 && y <= 10) {
                    checkTreasureGuess(x, y);
                } else {
                    showFeedback('treasureFeedback', 'Please enter numbers between 1 and 10!', false);
                }
            });
        }
        
        function generateTreasureProblem() {
            const treasureMap = document.getElementById('treasureMap');
            
            // Clear previous items
            treasureMap.querySelectorAll('.location-item').forEach(item => item.remove());
            
            // Set random treasure position
            targetPosition = {
                x: Math.floor(Math.random() * 10) + 1,
                y: Math.floor(Math.random() * 10) + 1
            };
            
            // Add treasure (hidden)
            const treasure = document.createElement('div');
            treasure.className = 'location-item treasure';
            treasure.id = 'treasureItem';
            treasure.style.left = `${(targetPosition.x - 1) * 50 + 25}px`;
            treasure.style.top = `${(targetPosition.y - 1) * 35 + 17}px`;
            treasure.innerHTML = 'üí∞';
            treasure.style.display = 'none';
            treasureMap.appendChild(treasure);
            
            // Add 3 landmarks
            for (let i = 0; i < 3; i++) {
                let x, y;
                do {
                    x = Math.floor(Math.random() * 10) + 1;
                    y = Math.floor(Math.random() * 10) + 1;
                } while (x === targetPosition.x && y === targetPosition.y);
                
                const landmark = document.createElement('div');
                landmark.className = 'location-item landmark';
                landmark.style.left = `${(x - 1) * 50 + 25}px`;
                landmark.style.top = `${(y - 1) * 35 + 17}px`;
                landmark.innerHTML = 'üå¥';
                landmark.title = `Landmark at (${x}, ${y})`;
                treasureMap.appendChild(landmark);
            }
            
            // Update mission
            document.getElementById('treasureObjective').textContent = 
                `The treasure is hidden at coordinates (${targetPosition.x}, ${targetPosition.y})`;
            
            showFeedback('treasureFeedback', 'Click on the map or enter coordinates to find the treasure!', true);
        }
        
        function checkTreasureGuess(x, y) {
            const distance = Math.abs(x - targetPosition.x) + Math.abs(y - targetPosition.y);
            
            if (distance === 0) {
                // Found treasure!
                document.getElementById('treasureItem').style.display = 'flex';
                showFeedback('treasureFeedback', 'üéâ You found the treasure! Great job! üéâ', true);
                
                // Update score
                updateScore(20);
                treasureFound++;
                treasureFoundElement.textContent = treasureFound;
                
                // New treasure after delay
                setTimeout(() => {
                    generateTreasureProblem();
                    document.getElementById('guessX').value = '';
                    document.getElementById('guessY').value = '';
                }, 1500);
            } else {
                // Give hints
                let message;
                if (distance === 1) message = 'So close! The treasure is right next to you!';
                else if (distance <= 3) message = 'You\'re getting warm! Keep looking.';
                else if (distance <= 5) message = 'You\'re in the right area.';
                else message = 'Not quite. Try a different location.';
                
                showFeedback('treasureFeedback', message, false);
            }
        }
        
        /* ----- NAVIGATION GAME ----- */
        function setupNavigationGame() {
            const dirBtns = document.querySelectorAll('.dir-btn[data-direction]');
            const checkBtn = document.getElementById('checkNavigation');
            
            // Direction buttons
            dirBtns.forEach(btn => {
                btn.addEventListener('click', () => {
                    movePlayer(btn.getAttribute('data-direction'));
                });
            });
            
            // Check position button
            checkBtn.addEventListener('click', checkNavigation);
        }
        
        function generateNavigationProblem() {
            const navMap = document.getElementById('navMap');
            
            // Clear previous items
            navMap.querySelectorAll('.location-item').forEach(item => item.remove());
            
            // Set start position
            currentPosition = { x: 1, y: 1 };
            
            // Set target position (not too close)
            do {
                targetPosition = {
                    x: Math.floor(Math.random() * 10) + 1,
                    y: Math.floor(Math.random() * 10) + 1
                };
            } while (Math.abs(targetPosition.x - currentPosition.x) + Math.abs(targetPosition.y - currentPosition.y) < 5);
            
            // Add player
            const player = document.createElement('div');
            player.className = 'location-item player';
            player.id = 'navPlayer';
            player.style.left = `${(currentPosition.x - 1) * 50 + 25}px`;
            player.style.top = `${(currentPosition.y - 1) * 35 + 17}px`;
            player.innerHTML = 'üß≠';
            navMap.appendChild(player);
            
            // Add target
            const target = document.createElement('div');
            target.className = 'location-item treasure';
            target.style.left = `${(targetPosition.x - 1) * 50 + 25}px`;
            target.style.top = `${(targetPosition.y - 1) * 35 + 17}px`;
            target.innerHTML = 'üéØ';
            navMap.appendChild(target);
            
            // Add 5 obstacles
            for (let i = 0; i < 5; i++) {
                let x, y;
                do {
                    x = Math.floor(Math.random() * 10) + 1;
                    y = Math.floor(Math.random() * 10) + 1;
                } while ((x === currentPosition.x && y === currentPosition.y) || 
                        (x === targetPosition.x && y === targetPosition.y));
                
                const obstacle = document.createElement('div');
                obstacle.className = 'location-item obstacle';
                obstacle.style.left = `${(x - 1) * 50 + 25}px`;
                obstacle.style.top = `${(y - 1) * 35 + 17}px`;
                obstacle.innerHTML = 'üöß';
                navMap.appendChild(obstacle);
            }
            
            // Update mission
            document.getElementById('navObjective').textContent = 
                `Navigate from (${currentPosition.x}, ${currentPosition.y}) to (${targetPosition.x}, ${targetPosition.y})`;
            
            showFeedback('navFeedback', 'Use the arrows to move around the map!', true);
        }
        
        function movePlayer(direction) {
            let newX = currentPosition.x;
            let newY = currentPosition.y;
            
            switch(direction) {
                case 'north': newY = Math.max(1, currentPosition.y - 1); break;
                case 'east': newX = Math.min(10, currentPosition.x + 1); break;
                case 'south': newY = Math.min(10, currentPosition.y + 1); break;
                case 'west': newX = Math.max(1, currentPosition.x - 1); break;
            }
            
            // Check for obstacles
            const obstacles = document.querySelectorAll('#navMap .obstacle');
            let canMove = true;
            
            obstacles.forEach(obstacle => {
                const obstacleX = Math.round((parseInt(obstacle.style.left) - 25) / 50) + 1;
                const obstacleY = Math.round((parseInt(obstacle.style.top) - 17) / 35) + 1;
                
                if (obstacleX === newX && obstacleY === newY) {
                    canMove = false;
                    showFeedback('navFeedback', 'Cannot move there! There\'s an obstacle.', false);
                }
            });
            
            if (canMove) {
                currentPosition.x = newX;
                currentPosition.y = newY;
                
                const player = document.getElementById('navPlayer');
                player.style.left = `${(currentPosition.x - 1) * 50 + 25}px`;
                player.style.top = `${(currentPosition.y - 1) * 35 + 17}px`;
                
                showFeedback('navFeedback', `Moved to (${currentPosition.x}, ${currentPosition.y})`, true);
            }
        }
        
        function checkNavigation() {
            const distance = Math.abs(currentPosition.x - targetPosition.x) + Math.abs(currentPosition.y - targetPosition.y);
            
            if (distance === 0) {
                showFeedback('navFeedback', 'üéâ Excellent! You reached the destination! üéâ', true);
                updateScore(25);
                
                setTimeout(() => {
                    generateNavigationProblem();
                }, 1500);
            } else {
                let message;
                if (distance === 1) message = 'So close! The destination is right next to you!';
                else if (distance <= 3) message = 'You\'re getting close! Keep going!';
                else message = 'Not quite there yet. Keep navigating!';
                
                showFeedback('navFeedback', message, false);
            }
        }
        
        /* ----- COORDINATES GAME ----- */
        function setupCoordinatesGame() {
            const coordMap = document.getElementById('coordMap');
            
            // Allow dropping
            coordMap.addEventListener('dragover', (e) => {
                e.preventDefault();
            });
            
            coordMap.addEventListener('drop', (e) => {
                e.preventDefault();
                if (draggedItem) {
                    const rect = coordMap.getBoundingClientRect();
                    const x = Math.floor((e.clientX - rect.left) / (rect.width / 10)) + 1;
                    const y = Math.floor((e.clientY - rect.top) / (rect.height / 10)) + 1;
                    
                    // Position the item
                    draggedItem.style.position = 'absolute';
                    draggedItem.style.left = `${(x - 1) * 50 + 25}px`;
                    draggedItem.style.top = `${(y - 1) * 35 + 17}px`;
                    draggedItem.setAttribute('data-position', `${x},${y}`);
                    
                    coordMap.appendChild(draggedItem);
                    draggedItem = null;
                }
            });
            
            // Check answers button
            document.getElementById('checkCoordinates').addEventListener('click', checkCoordinatePlacements);
        }
        
        function generateCoordinatesProblem() {
            const itemPalette = document.getElementById('itemPalette');
            const coordMap = document.getElementById('coordMap');
            
            // Clear previous items
            itemPalette.innerHTML = '';
            coordMap.querySelectorAll('.location-item').forEach(item => item.remove());
            
            // Create 3 items to place
            const items = [
                { type: 'üè†', correctX: 3, correctY: 7 },
                { type: 'üè´', correctX: 8, correctY: 2 },
                { type: 'üè•', correctX: 5, correctY: 5 }
            ];
            
            // Add items to palette
            items.forEach(item => {
                const paletteItem = document.createElement('div');
                paletteItem.className = 'palette-item';
                paletteItem.innerHTML = item.type;
                paletteItem.setAttribute('draggable', 'true');
                paletteItem.setAttribute('data-type', item.type);
                paletteItem.setAttribute('data-correct', `${item.correctX},${item.correctY}`);
                
                paletteItem.addEventListener('dragstart', (e) => {
                    draggedItem = paletteItem.cloneNode(true);
                    draggedItem.style.position = 'absolute';
                });
                
                itemPalette.appendChild(paletteItem);
            });
            
            // Update mission
            document.getElementById('coordObjective').textContent = 
                'Place the house (üè†) at (3,7), school (üè´) at (8,2), and hospital (üè•) at (5,5)';
            
            showFeedback('coordFeedback', 'Drag items from the palette to their correct coordinates!', true);
        }
        
        function checkCoordinatePlacements() {
            const placedItems = document.querySelectorAll('#coordMap .location-item');
            let correctCount = 0;
            
            placedItems.forEach(item => {
                const position = item.getAttribute('data-position');
                const correctPosition = item.getAttribute('data-correct');
                
                if (position === correctPosition) {
                    correctCount++;
                    item.style.background = '#a3e4d7';
                } else {
                    item.style.background = '#f5b7b1';
                }
            });
            
            if (correctCount === placedItems.length && placedItems.length === 3) {
                showFeedback('coordFeedback', 'üéâ Perfect! All items are in the correct positions! üéâ', true);
                updateScore(30);
                
                setTimeout(() => {
                    generateCoordinatesProblem();
                }, 1500);
            } else {
                showFeedback('coordFeedback', 
                    `${correctCount} out of 3 items are correctly placed. Keep trying!`, false);
            }
        }
        
        /* ----- HELPER FUNCTIONS ----- */
        function showFeedback(elementId, message, isCorrect) {
            const element = document.getElementById(elementId);
            element.textContent = message;
            element.className = `feedback ${isCorrect ? 'correct' : 'incorrect'}`;
        }
        
        function updateScore(points) {
            score += points;
            scoreElement.textContent = score;
            
            // Level up every 100 points
            const newLevel = Math.floor(score / 100) + 1;
            if (newLevel > level) {
                level = newLevel;
                levelElement.textContent = level;
            }
        }
        
        // Start the game when page loads
        window.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>