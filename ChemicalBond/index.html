<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chemical Bond Match</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #1a1b2e 0%, #0c0d1a 100%);
            color: white;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            margin-bottom: 30px;
            padding: 25px;
            background: rgba(255, 107, 107, 0.15);
            border-radius: 20px;
            border: 3px solid #ff6b6b;
            box-shadow: 0 10px 30px rgba(255, 107, 107, 0.2);
        }

        h1 {
            font-size: 3rem;
            margin-bottom: 10px;
            color: #4ecdc4;
            text-shadow: 0 2px 10px rgba(78, 205, 196, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 20px;
        }

        .subtitle {
            font-size: 1.2rem;
            opacity: 0.9;
            margin-bottom: 15px;
            color: #ffd166;
        }

        .game-info {
            display: flex;
            justify-content: space-between;
            background: rgba(17, 138, 178, 0.2);
            padding: 15px 30px;
            border-radius: 15px;
            margin-bottom: 30px;
            border: 2px solid #118ab2;
        }

        .info-box {
            text-align: center;
            flex: 1;
        }

        .info-label {
            font-size: 1rem;
            color: #4ecdc4;
            margin-bottom: 5px;
        }

        .info-value {
            font-size: 2.5rem;
            font-weight: bold;
            color: #ffd166;
        }

        .game-area {
            display: grid;
            grid-template-columns: 1fr 300px;
            gap: 20px;
            margin-bottom: 30px;
        }

        @media (max-width: 900px) {
            .game-area {
                grid-template-columns: 1fr;
            }
        }

        .elements-grid {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 20px;
            padding: 25px;
            border: 3px solid #4ecdc4;
            box-shadow: 0 8px 25px rgba(78, 205, 196, 0.2);
        }

        .target-area {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 20px;
            padding: 25px;
            border: 3px solid #ffd166;
            box-shadow: 0 8px 25px rgba(255, 209, 102, 0.2);
        }

        .panel-title {
            color: #4ecdc4;
            margin-bottom: 20px;
            font-size: 1.8rem;
            display: flex;
            align-items: center;
            gap: 10px;
            border-bottom: 2px solid #4ecdc4;
            padding-bottom: 10px;
        }

        .target-area .panel-title {
            color: #ffd166;
            border-color: #ffd166;
        }

        .grid-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .element-card {
            background: linear-gradient(145deg, #2d3047, #1c1e2e);
            border-radius: 15px;
            padding: 20px 10px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 3px solid transparent;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            user-select: none;
            position: relative;
            overflow: hidden;
        }

        .element-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(255, 209, 102, 0.3);
        }

        .element-card.selected {
            border-color: #06d6a0;
            background: linear-gradient(145deg, #1e4031, #0d2818);
            box-shadow: 0 5px 20px rgba(6, 214, 160, 0.4);
        }

        .element-symbol {
            font-size: 2.5rem;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .element-name {
            font-size: 0.9rem;
            opacity: 0.9;
            color: #ffd166;
        }

        .element-charge {
            position: absolute;
            top: 8px;
            right: 8px;
            background: rgba(0, 0, 0, 0.6);
            border-radius: 50%;
            width: 25px;
            height: 25px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 0.9rem;
        }

        .element-card.cation .element-charge {
            color: #ef476f;
            border: 2px solid #ef476f;
        }

        .element-card.anion .element-charge {
            color: #118ab2;
            border: 2px solid #118ab2;
        }

        .bonding-area {
            min-height: 400px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 20px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 15px;
            margin-top: 20px;
            border: 2px dashed rgba(255, 255, 255, 0.1);
        }

        .selected-elements {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 20px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .selected-element {
            background: rgba(255, 255, 255, 0.1);
            padding: 15px 25px;
            border-radius: 15px;
            border: 2px solid #4ecdc4;
            min-width: 120px;
            text-align: center;
            font-size: 1.5rem;
            font-weight: bold;
        }

        .bond-arrow {
            color: #ffd166;
            font-size: 2rem;
        }

        .result-compound {
            font-size: 3rem;
            font-weight: bold;
            color: #ffd166;
            margin-top: 20px;
            padding: 15px 30px;
            background: rgba(0, 0, 0, 0.4);
            border-radius: 15px;
            border: 3px solid #ef476f;
            text-align: center;
            min-width: 200px;
        }

        .action-buttons {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 30px;
        }

        button {
            padding: 15px 30px;
            border: none;
            border-radius: 50px;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 10px;
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.4);
        }

        #bond-btn {
            background: linear-gradient(to right, #06d6a0, #05b888);
            color: white;
        }

        #bond-btn:hover {
            background: linear-gradient(to right, #05b888, #049c73);
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(6, 214, 160, 0.4);
        }

        #clear-btn {
            background: linear-gradient(to right, #ffd166, #ffc043);
            color: white;
        }

        #clear-btn:hover {
            background: linear-gradient(to right, #ffc043, #ffb030);
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(255, 209, 102, 0.4);
        }

        #next-btn {
            background: linear-gradient(to right, #9d4edd, #7b2cbf);
            color: white;
        }

        #next-btn:hover {
            background: linear-gradient(to right, #7b2cbf, #5a189a);
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(157, 78, 221, 0.4);
        }

        .instructions {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 20px;
            padding: 25px;
            margin-top: 30px;
            border-left: 5px solid #4ecdc4;
        }

        .instructions h3 {
            color: #4ecdc4;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .instructions ul {
            padding-left: 25px;
        }

        .instructions li {
            margin-bottom: 10px;
            line-height: 1.6;
        }

        .instructions strong {
            color: #ffd166;
        }

        .compound-history {
            margin-top: 20px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 15px;
            padding: 15px;
            max-height: 150px;
            overflow-y: auto;
        }

        .history-title {
            color: #ffd166;
            margin-bottom: 10px;
            font-size: 1.1rem;
        }

        .history-item {
            display: flex;
            justify-content: space-between;
            padding: 8px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .history-formula {
            font-weight: bold;
            color: #4ecdc4;
        }

        .history-name {
            color: #aaa;
            font-size: 0.9rem;
        }

        .feedback {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.95);
            border-radius: 20px;
            padding: 40px;
            width: 500px;
            max-width: 90%;
            z-index: 1000;
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.8);
            border: 4px solid;
            display: none;
            text-align: center;
        }

        .feedback.success {
            border-color: #06d6a0;
        }

        .feedback.error {
            border-color: #ef476f;
        }

        .feedback-title {
            font-size: 2.2rem;
            margin-bottom: 20px;
            color: inherit;
        }

        .success .feedback-title {
            color: #06d6a0;
        }

        .error .feedback-title {
            color: #ef476f;
        }

        .feedback-content {
            font-size: 1.2rem;
            line-height: 1.6;
            margin-bottom: 25px;
        }

        .feedback-btn {
            padding: 12px 30px;
            border-radius: 10px;
            font-weight: bold;
            cursor: pointer;
            border: none;
            font-size: 1.1rem;
        }

        .continue-btn {
            background: #06d6a0;
            color: white;
        }

        .close-btn {
            background: #ef476f;
            color: white;
        }

        .game-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 999;
            display: none;
        }

        .level-indicator {
            background: rgba(157, 78, 221, 0.2);
            padding: 10px 20px;
            border-radius: 10px;
            border: 2px solid #9d4edd;
            display: inline-block;
            margin-bottom: 15px;
        }

        .level-text {
            color: #9d4edd;
            font-weight: bold;
            font-size: 1.2rem;
        }

        .target-compounds {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 15px;
        }

        .target-compound {
            background: rgba(239, 71, 111, 0.2);
            padding: 10px 15px;
            border-radius: 10px;
            border: 2px solid #ef476f;
            font-weight: bold;
            color: #ffd166;
        }

        .element-info {
            font-size: 0.8rem;
            margin-top: 5px;
            color: #aaa;
        }

        .element-card.disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none !important;
            box-shadow: none !important;
        }

        @keyframes celebrate {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        .celebrate {
            animation: celebrate 0.5s ease 3;
        }

        footer {
            text-align: center;
            margin-top: 40px;
            padding: 20px;
            color: rgba(255, 255, 255, 0.6);
            font-size: 0.9rem;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }
    </style>
</head>
<body>
    <div class="game-overlay" id="game-overlay"></div>
    
    <div class="container">
        <header>
            <h1><i class="fas fa-atom"></i> Chemical Bond Match</h1>
            <p class="subtitle">Match cations and anions to form correct chemical compounds!</p>
            <div class="level-indicator">
                <span class="level-text">Level <span id="level">1</span>/10</span>
            </div>
        </header>
        
        <div class="game-info">
            <div class="info-box">
                <div class="info-label">Score</div>
                <div class="info-value" id="score">0</div>
            </div>
            <div class="info-box">
                <div class="info-label">Compounds Formed</div>
                <div class="info-value" id="compounds">0</div>
            </div>
            <div class="info-box">
                <div class="info-label">Accuracy</div>
                <div class="info-value" id="accuracy">100%</div>
            </div>
        </div>
        
        <div class="game-area">
            <div class="elements-grid">
                <h2 class="panel-title"><i class="fas fa-flask"></i> Available Elements</h2>
                <p>Select one cation (+) and one anion (-) to form a compound:</p>
                
                <div class="grid-container" id="elements-container">
                    <!-- Elements will be loaded here -->
                </div>
            </div>
            
            <div class="target-area">
                <h2 class="panel-title"><i class="fas fa-bullseye"></i> Bonding Zone</h2>
                
                <div class="bonding-area">
                    <div class="selected-elements">
                        <div class="selected-element" id="selected-cation">?</div>
                        <span class="bond-arrow"><i class="fas fa-plus"></i></span>
                        <div class="selected-element" id="selected-anion">?</div>
                        <span class="bond-arrow"><i class="fas fa-arrow-right"></i></span>
                        <div class="result-compound" id="result-compound">???</div>
                    </div>
                    
                    <div class="compound-history">
                        <div class="history-title">Recently Formed:</div>
                        <div id="history-list">
                            <!-- History items will be added here -->
                        </div>
                    </div>
                </div>
                
                <div class="action-buttons">
                    <button id="bond-btn">
                        <i class="fas fa-link"></i> Form Bond
                    </button>
                    <button id="clear-btn">
                        <i class="fas fa-eraser"></i> Clear
                    </button>
                    <button id="next-btn">
                        <i class="fas fa-forward"></i> Next Level
                    </button>
                </div>
            </div>
        </div>
        
        <div class="instructions">
            <h3><i class="fas fa-graduation-cap"></i> How Ionic Bonding Works</h3>
            <ul>
                <li><strong>Cations (+) lose electrons</strong> and have positive charge</li>
                <li><strong>Anions (-) gain electrons</strong> and have negative charge</li>
                <li><strong>Opposite charges attract</strong> to form ionic compounds</li>
                <li><strong>Balance the charges</strong> to create neutral compounds</li>
                <li><strong>Example:</strong> Na⁺ + Cl⁻ → NaCl (Sodium Chloride)</li>
            </ul>
        </div>
        
        <footer>
            <p>Chemical Bond Match | Practice ionic compound formation through element matching</p>
            <p>Made with <i class="fas fa-atom" style="color:#4ecdc4;"></i> for chemistry enthusiasts</p>
        </footer>
    </div>
    
    <!-- Feedback Messages -->
    <div class="feedback success" id="success-feedback">
        <h2 class="feedback-title"><i class="fas fa-check-circle"></i> Bond Formed!</h2>
        <div class="feedback-content" id="success-content">You created a valid compound!</div>
        <button class="feedback-btn continue-btn" id="continue-btn">Continue</button>
    </div>
    
    <div class="feedback error" id="error-feedback">
        <h2 class="feedback-title"><i class="fas fa-times-circle"></i> Invalid Bond</h2>
        <div class="feedback-content" id="error-content">These elements cannot form a stable compound.</div>
        <button class="feedback-btn close-btn" id="close-error-btn">Try Again</button>
    </div>

    <script>
        // Game data
        const gameData = {
            level: 1,
            maxLevel: 10,
            score: 0,
            totalCompounds: 0,
            correctCompounds: 0,
            selectedCation: null,
            selectedAnion: null,
            history: [],
            levelCompounds: []
        };

        // Element database with charges and common compounds
        const elements = [
            // Cations (+)
            { symbol: "Na", name: "Sodium", charge: "+1", type: "cation", color: "#ff6b6b" },
            { symbol: "K", name: "Potassium", charge: "+1", type: "cation", color: "#ef476f" },
            { symbol: "Mg", name: "Magnesium", charge: "+2", type: "cation", color: "#ff9e00" },
            { symbol: "Ca", name: "Calcium", charge: "+2", type: "cation", color: "#ffb347" },
            { symbol: "Al", name: "Aluminum", charge: "+3", type: "cation", color: "#ff6b8b" },
            { symbol: "Fe", name: "Iron(II)", charge: "+2", type: "cation", color: "#b5651d" },
            { symbol: "Fe", name: "Iron(III)", charge: "+3", type: "cation", color: "#8b4513" },
            { symbol: "Cu", name: "Copper(I)", charge: "+1", type: "cation", color: "#b87333" },
            { symbol: "Cu", name: "Copper(II)", charge: "+2", type: "cation", color: "#daa520" },
            { symbol: "Ag", name: "Silver", charge: "+1", type: "cation", color: "#c0c0c0" },
            { symbol: "Zn", name: "Zinc", charge: "+2", type: "cation", color: "#a8a8a8" },
            { symbol: "NH₄", name: "Ammonium", charge: "+1", type: "cation", color: "#4ecdc4" },
            
            // Anions (-)
            { symbol: "Cl", name: "Chloride", charge: "-1", type: "anion", color: "#118ab2" },
            { symbol: "Br", name: "Bromide", charge: "-1", type: "anion", color: "#06d6a0" },
            { symbol: "I", name: "Iodide", charge: "-1", type: "anion", color: "#073b4c" },
            { symbol: "O", name: "Oxide", charge: "-2", type: "anion", color: "#ef476f" },
            { symbol: "S", name: "Sulfide", charge: "-2", type: "anion", color: "#ffd166" },
            { symbol: "SO₄", name: "Sulfate", charge: "-2", type: "anion", color: "#ff9e00" },
            { symbol: "NO₃", name: "Nitrate", charge: "-1", type: "anion", color: "#9d4edd" },
            { symbol: "CO₃", name: "Carbonate", charge: "-2", type: "anion", color: "#38b000" },
            { symbol: "PO₄", name: "Phosphate", charge: "-3", type: "anion", color: "#ffafcc" },
            { symbol: "OH", name: "Hydroxide", charge: "-1", type: "anion", color: "#4cc9f0" },
            { symbol: "F", name: "Fluoride", charge: "-1", type: "anion", color: "#90e0ef" },
            { symbol: "N", name: "Nitride", charge: "-3", type: "anion", color: "#7209b7" }
        ];

        // Valid compound formations (cation + anion → compound)
        const validCompounds = [
            // Sodium compounds
            { cation: "Na", anion: "Cl", compound: "NaCl", name: "Sodium Chloride" },
            { cation: "Na", anion: "Br", compound: "NaBr", name: "Sodium Bromide" },
            { cation: "Na", anion: "I", compound: "NaI", name: "Sodium Iodide" },
            { cation: "Na", anion: "OH", compound: "NaOH", name: "Sodium Hydroxide" },
            { cation: "Na", anion: "NO₃", compound: "NaNO₃", name: "Sodium Nitrate" },
            { cation: "Na", anion: "CO₃", compound: "Na₂CO₃", name: "Sodium Carbonate" },
            { cation: "Na", anion: "SO₄", compound: "Na₂SO₄", name: "Sodium Sulfate" },
            { cation: "Na", anion: "PO₄", compound: "Na₃PO₄", name: "Sodium Phosphate" },
            
            // Potassium compounds
            { cation: "K", anion: "Cl", compound: "KCl", name: "Potassium Chloride" },
            { cation: "K", anion: "Br", compound: "KBr", name: "Potassium Bromide" },
            { cation: "K", anion: "I", compound: "KI", name: "Potassium Iodide" },
            { cation: "K", anion: "OH", compound: "KOH", name: "Potassium Hydroxide" },
            { cation: "K", anion: "NO₃", compound: "KNO₃", name: "Potassium Nitrate" },
            
            // Magnesium compounds
            { cation: "Mg", anion: "Cl", compound: "MgCl₂", name: "Magnesium Chloride" },
            { cation: "Mg", anion: "O", compound: "MgO", name: "Magnesium Oxide" },
            { cation: "Mg", anion: "SO₄", compound: "MgSO₄", name: "Magnesium Sulfate" },
            { cation: "Mg", anion: "OH", compound: "Mg(OH)₂", name: "Magnesium Hydroxide" },
            { cation: "Mg", anion: "CO₃", compound: "MgCO₃", name: "Magnesium Carbonate" },
            
            // Calcium compounds
            { cation: "Ca", anion: "Cl", compound: "CaCl₂", name: "Calcium Chloride" },
            { cation: "Ca", anion: "O", compound: "CaO", name: "Calcium Oxide" },
            { cation: "Ca", anion: "CO₃", compound: "CaCO₃", name: "Calcium Carbonate" },
            { cation: "Ca", anion: "SO₄", compound: "CaSO₄", name: "Calcium Sulfate" },
            { cation: "Ca", anion: "OH", compound: "Ca(OH)₂", name: "Calcium Hydroxide" },
            
            // Aluminum compounds
            { cation: "Al", anion: "Cl", compound: "AlCl₃", name: "Aluminum Chloride" },
            { cation: "Al", anion: "O", compound: "Al₂O₃", name: "Aluminum Oxide" },
            { cation: "Al", anion: "SO₄", compound: "Al₂(SO₄)₃", name: "Aluminum Sulfate" },
            
            // Iron compounds
            { cation: "Fe", anion: "Cl", compound: "FeCl₂", name: "Iron(II) Chloride" },
            { cation: "Fe", anion: "Cl", compound: "FeCl₃", name: "Iron(III) Chloride" },
            { cation: "Fe", anion: "O", compound: "FeO", name: "Iron(II) Oxide" },
            { cation: "Fe", anion: "O", compound: "Fe₂O₃", name: "Iron(III) Oxide" },
            { cation: "Fe", anion: "SO₄", compound: "FeSO₄", name: "Iron(II) Sulfate" },
            
            // Copper compounds
            { cation: "Cu", anion: "Cl", compound: "CuCl", name: "Copper(I) Chloride" },
            { cation: "Cu", anion: "Cl", compound: "CuCl₂", name: "Copper(II) Chloride" },
            { cation: "Cu", anion: "O", compound: "Cu₂O", name: "Copper(I) Oxide" },
            { cation: "Cu", anion: "O", compound: "CuO", name: "Copper(II) Oxide" },
            { cation: "Cu", anion: "SO₄", compound: "CuSO₄", name: "Copper(II) Sulfate" },
            
            // Silver compounds
            { cation: "Ag", anion: "Cl", compound: "AgCl", name: "Silver Chloride" },
            { cation: "Ag", anion: "Br", compound: "AgBr", name: "Silver Bromide" },
            { cation: "Ag", anion: "I", compound: "AgI", name: "Silver Iodide" },
            { cation: "Ag", anion: "NO₃", compound: "AgNO₃", name: "Silver Nitrate" },
            
            // Zinc compounds
            { cation: "Zn", anion: "Cl", compound: "ZnCl₂", name: "Zinc Chloride" },
            { cation: "Zn", anion: "O", compound: "ZnO", name: "Zinc Oxide" },
            { cation: "Zn", anion: "SO₄", compound: "ZnSO₄", name: "Zinc Sulfate" },
            
            // Ammonium compounds
            { cation: "NH₄", anion: "Cl", compound: "NH₄Cl", name: "Ammonium Chloride" },
            { cation: "NH₄", anion: "NO₃", compound: "NH₄NO₃", name: "Ammonium Nitrate" },
            { cation: "NH₄", anion: "OH", compound: "NH₄OH", name: "Ammonium Hydroxide" },
            { cation: "NH₄", anion: "SO₄", compound: "(NH₄)₂SO₄", name: "Ammonium Sulfate" }
        ];

        // Game levels
        const levels = [
            {
                level: 1,
                title: "Simple Salts",
                description: "Form simple 1:1 ratio compounds",
                requiredCompounds: 3,
                elements: ["Na", "K", "Cl", "Br", "I", "NO₃", "OH"],
                targetCompounds: ["NaCl", "KBr", "NaNO₃"]
            },
            {
                level: 2,
                title: "Divalent Metals",
                description: "Compounds with +2 metals",
                requiredCompounds: 4,
                elements: ["Mg", "Ca", "Cl", "O", "OH", "SO₄"],
                targetCompounds: ["MgCl₂", "CaO", "Mg(OH)₂", "CaSO₄"]
            },
            {
                level: 3,
                title: "Trivalent Challenge",
                description: "Compounds with +3 metals",
                requiredCompounds: 3,
                elements: ["Al", "Fe", "Cl", "O", "SO₄"],
                targetCompounds: ["AlCl₃", "Fe₂O₃", "Al₂(SO₄)₃"]
            },
            {
                level: 4,
                title: "Transition Metals",
                description: "Compounds with variable charges",
                requiredCompounds: 4,
                elements: ["Fe", "Cu", "Cl", "O", "SO₄"],
                targetCompounds: ["FeCl₂", "FeCl₃", "CuO", "CuSO₄"]
            },
            {
                level: 5,
                title: "Carbonates & Sulfates",
                description: "Polyatomic ions",
                requiredCompounds: 4,
                elements: ["Na", "Ca", "Mg", "CO₃", "SO₄", "PO₄"],
                targetCompounds: ["Na₂CO₃", "CaCO₃", "MgSO₄", "Na₃PO₄"]
            },
            {
                level: 6,
                title: "Ammonium Salts",
                description: "Compounds with ammonium ion",
                requiredCompounds: 3,
                elements: ["NH₄", "Cl", "NO₃", "OH", "SO₄"],
                targetCompounds: ["NH₄Cl", "NH₄NO₃", "(NH₄)₂SO₄"]
            },
            {
                level: 7,
                title: "Mixed Valency",
                description: "Various charge combinations",
                requiredCompounds: 5,
                elements: ["Na", "Mg", "Al", "Cl", "O", "OH", "SO₄"],
                targetCompounds: ["NaCl", "MgO", "AlCl₃", "NaOH", "MgSO₄"]
            },
            {
                level: 8,
                title: "Silver & Zinc",
                description: "Less common metals",
                requiredCompounds: 4,
                elements: ["Ag", "Zn", "Cl", "Br", "O", "NO₃"],
                targetCompounds: ["AgCl", "AgNO₃", "ZnO", "ZnCl₂"]
            },
            {
                level: 9,
                title: "Advanced Combinations",
                description: "Complex compound formation",
                requiredCompounds: 5,
                elements: ["Ca", "Al", "Fe", "O", "CO₃", "PO₄", "OH"],
                targetCompounds: ["Ca(OH)₂", "AlPO₄", "FePO₄", "Ca₃(PO₄)₂", "Al(OH)₃"]
            },
            {
                level: 10,
                title: "Master Chemist",
                description: "All elements challenge",
                requiredCompounds: 6,
                elements: ["Na", "Mg", "Al", "Ca", "Fe", "NH₄", "Cl", "O", "SO₄", "CO₃", "OH"],
                targetCompounds: ["Na₂CO₃", "MgCl₂", "Al₂O₃", "CaSO₄", "Fe(OH)₂", "NH₄OH"]
            }
        ];

        // DOM elements
        const levelElement = document.getElementById('level');
        const scoreElement = document.getElementById('score');
        const compoundsElement = document.getElementById('compounds');
        const accuracyElement = document.getElementById('accuracy');
        const elementsContainer = document.getElementById('elements-container');
        const selectedCation = document.getElementById('selected-cation');
        const selectedAnion = document.getElementById('selected-anion');
        const resultCompound = document.getElementById('result-compound');
        const historyList = document.getElementById('history-list');
        const bondBtn = document.getElementById('bond-btn');
        const clearBtn = document.getElementById('clear-btn');
        const nextBtn = document.getElementById('next-btn');
        const successFeedback = document.getElementById('success-feedback');
        const errorFeedback = document.getElementById('error-feedback');
        const successContent = document.getElementById('success-content');
        const errorContent = document.getElementById('error-content');
        const continueBtn = document.getElementById('continue-btn');
        const closeErrorBtn = document.getElementById('close-error-btn');
        const gameOverlay = document.getElementById('game-overlay');

        // Initialize the game
        function initGame() {
            loadLevel(1);
            
            // Event listeners
            bondBtn.addEventListener('click', formBond);
            clearBtn.addEventListener('click', clearSelection);
            nextBtn.addEventListener('click', nextLevel);
            continueBtn.addEventListener('click', closeSuccessFeedback);
            closeErrorBtn.addEventListener('click', closeErrorFeedback);
            
            // Initial display update
            updateDisplay();
        }

        // Load a level
        function loadLevel(levelNumber) {
            gameData.level = levelNumber;
            const level = levels.find(l => l.level === levelNumber);
            
            if (!level) return;
            
            // Reset level data
            gameData.selectedCation = null;
            gameData.selectedAnion = null;
            gameData.levelCompounds = [];
            
            // Update UI
            levelElement.textContent = levelNumber;
            
            // Load elements for this level
            loadElements(level);
            
            // Update compound result display
            resultCompound.textContent = "???";
            resultCompound.style.borderColor = "#ef476f";
            
            // Hide next button initially
            nextBtn.style.display = 'none';
            
            // Clear selection displays
            selectedCation.textContent = "?";
            selectedCation.style.borderColor = "#4ecdc4";
            selectedAnion.textContent = "?";
            selectedAnion.style.borderColor = "#4ecdc4";
        }

        // Load elements for current level
        function loadElements(level) {
            elementsContainer.innerHTML = '';
            
            // Separate cations and anions
            const cations = elements.filter(e => 
                e.type === "cation" && level.elements.includes(e.symbol)
            );
            
            const anions = elements.filter(e => 
                e.type === "anion" && level.elements.includes(e.symbol)
            );
            
            // Add cation section
            if (cations.length > 0) {
                const cationHeader = document.createElement('div');
                cationHeader.className = 'element-info';
                cationHeader.style.gridColumn = '1 / -1';
                cationHeader.style.color = '#ff6b6b';
                cationHeader.style.fontWeight = 'bold';
                cationHeader.style.marginTop = '10px';
                cationHeader.textContent = 'CATIONS (+)';
                elementsContainer.appendChild(cationHeader);
                
                cations.forEach(element => {
                    elementsContainer.appendChild(createElementCard(element));
                });
            }
            
            // Add anion section
            if (anions.length > 0) {
                const anionHeader = document.createElement('div');
                anionHeader.className = 'element-info';
                anionHeader.style.gridColumn = '1 / -1';
                anionHeader.style.color = '#118ab2';
                anionHeader.style.fontWeight = 'bold';
                anionHeader.style.marginTop = '20px';
                anionHeader.textContent = 'ANIONS (-)';
                elementsContainer.appendChild(anionHeader);
                
                anions.forEach(element => {
                    elementsContainer.appendChild(createElementCard(element));
                });
            }
        }

        // Create an element card
        function createElementCard(element) {
            const card = document.createElement('div');
            card.className = `element-card ${element.type}`;
            card.dataset.symbol = element.symbol;
            card.dataset.type = element.type;
            
            card.innerHTML = `
                <div class="element-symbol" style="color:${element.color}">${element.symbol}</div>
                <div class="element-name">${element.name}</div>
                <div class="element-charge">${element.charge}</div>
            `;
            
            card.addEventListener('click', () => selectElement(element));
            return card;
        }

        // Select an element
        function selectElement(element) {
            // Clear previous selection of same type
            const sameTypeCards = document.querySelectorAll(`.element-card.${element.type}.selected`);
            sameTypeCards.forEach(card => card.classList.remove('selected'));
            
            // Select new element
            const card = document.querySelector(`.element-card[data-symbol="${element.symbol}"][data-type="${element.type}"]`);
            if (card) {
                card.classList.add('selected');
                
                if (element.type === "cation") {
                    gameData.selectedCation = element;
                    selectedCation.textContent = `${element.symbol}${element.charge}`;
                    selectedCation.style.borderColor = element.color;
                } else {
                    gameData.selectedAnion = element;
                    selectedAnion.textContent = `${element.symbol}${element.charge}`;
                    selectedAnion.style.borderColor = element.color;
                }
            }
            
            // Update compound prediction
            updateCompoundPrediction();
        }

        // Update the predicted compound formula
        function updateCompoundPrediction() {
            if (gameData.selectedCation && gameData.selectedAnion) {
                // Try to find a valid compound
                const validCompound = validCompounds.find(c => 
                    c.cation === gameData.selectedCation.symbol && 
                    c.anion === gameData.selectedAnion.symbol
                );
                
                if (validCompound) {
                    resultCompound.textContent = validCompound.compound;
                    resultCompound.style.borderColor = "#06d6a0";
                } else {
                    resultCompound.textContent = "Invalid";
                    resultCompound.style.borderColor = "#ef476f";
                }
            } else {
                resultCompound.textContent = "???";
                resultCompound.style.borderColor = "#ef476f";
            }
        }

        // Form a bond between selected elements
        function formBond() {
            if (!gameData.selectedCation || !gameData.selectedAnion) {
                showError("Please select both a cation and an anion.");
                return;
            }
            
            // Find if this is a valid compound
            const validCompound = validCompounds.find(c => 
                c.cation === gameData.selectedCation.symbol && 
                c.anion === gameData.selectedAnion.symbol
            );
            
            gameData.totalCompounds++;
            
            if (validCompound) {
                // Success!
                gameData.correctCompounds++;
                gameData.score += 100;
                
                // Add to history
                gameData.history.unshift({
                    formula: validCompound.compound,
                    name: validCompound.name
                });
                
                // Limit history to 5 items
                if (gameData.history.length > 5) {
                    gameData.history.pop();
                }
                
                // Add to level compounds
                const currentLevel = levels.find(l => l.level === gameData.level);
                if (currentLevel.targetCompounds.includes(validCompound.compound)) {
                    if (!gameData.levelCompounds.includes(validCompound.compound)) {
                        gameData.levelCompounds.push(validCompound.compound);
                    }
                }
                
                // Update displays
                updateDisplay();
                updateHistory();
                
                // Show success message
                successContent.textContent = `You formed ${validCompound.name} (${validCompound.compound})! +100 points`;
                showFeedback(successFeedback);
                
                // Check if level is complete
                checkLevelCompletion();
                
                // Celebrate animation
                resultCompound.classList.add('celebrate');
                setTimeout(() => resultCompound.classList.remove('celebrate'), 1500);
                
            } else {
                // Invalid compound
                gameData.score = Math.max(0, gameData.score - 50);
                updateDisplay();
                
                showError(`${gameData.selectedCation.symbol}${gameData.selectedCation.charge} and ${gameData.selectedAnion.symbol}${gameData.selectedAnion.charge} cannot form a stable compound.`);
            }
        }

        // Check if level is complete
        function checkLevelCompletion() {
            const currentLevel = levels.find(l => l.level === gameData.level);
            const uniqueCompounds = [...new Set(gameData.levelCompounds)];
            
            if (uniqueCompounds.length >= currentLevel.requiredCompounds) {
                // Level complete!
                nextBtn.style.display = 'flex';
                showFeedback(successFeedback, true);
                successContent.textContent = `Level ${gameData.level} Complete! You formed ${uniqueCompounds.length} required compounds.`;
            }
        }

        // Clear selection
        function clearSelection() {
            // Clear selected elements
            document.querySelectorAll('.element-card.selected').forEach(card => {
                card.classList.remove('selected');
            });
            
            // Reset game data
            gameData.selectedCation = null;
            gameData.selectedAnion = null;
            
            // Reset displays
            selectedCation.textContent = "?";
            selectedCation.style.borderColor = "#4ecdc4";
            selectedAnion.textContent = "?";
            selectedAnion.style.borderColor = "#4ecdc4";
            resultCompound.textContent = "???";
            resultCompound.style.borderColor = "#ef476f";
        }

        // Go to next level
        function nextLevel() {
            if (gameData.level < gameData.maxLevel) {
                loadLevel(gameData.level + 1);
                hideAllFeedback();
                nextBtn.style.display = 'none';
            } else {
                // Game complete
                showFeedback(successFeedback, true);
                successContent.textContent = `Congratulations! You've completed all ${gameData.maxLevel} levels! Final Score: ${gameData.score}`;
                nextBtn.textContent = "Play Again";
                nextBtn.onclick = () => location.reload();
            }
        }

        // Update all displays
        function updateDisplay() {
            scoreElement.textContent = gameData.score;
            compoundsElement.textContent = gameData.correctCompounds;
            
            // Calculate accuracy
            const accuracy = gameData.totalCompounds > 0 
                ? Math.round((gameData.correctCompounds / gameData.totalCompounds) * 100)
                : 100;
            accuracyElement.textContent = `${accuracy}%`;
            
            // Update level info
            const currentLevel = levels.find(l => l.level === gameData.level);
            const levelInfo = document.querySelector('.level-indicator .level-text');
            if (levelInfo) {
                levelInfo.innerHTML = `Level ${gameData.level}/10: ${currentLevel.title}`;
            }
        }

        // Update history display
        function updateHistory() {
            historyList.innerHTML = '';
            gameData.history.forEach(item => {
                const historyItem = document.createElement('div');
                historyItem.className = 'history-item';
                historyItem.innerHTML = `
                    <span class="history-formula">${item.formula}</span>
                    <span class="history-name">${item.name}</span>
                `;
                historyList.appendChild(historyItem);
            });
        }

        // Show feedback
        function showFeedback(element, isLevelComplete = false) {
            element.style.display = 'block';
            gameOverlay.style.display = 'block';
            
            if (isLevelComplete) {
                const continueBtn = element.querySelector('.continue-btn');
                if (continueBtn) {
                    continueBtn.textContent = "Next Level";
                    continueBtn.onclick = nextLevel;
                }
            }
        }

        // Show error message
        function showError(message) {
            errorContent.textContent = message;
            showFeedback(errorFeedback);
        }

        // Close success feedback
        function closeSuccessFeedback() {
            successFeedback.style.display = 'none';
            gameOverlay.style.display = 'none';
        }

        // Close error feedback
        function closeErrorFeedback() {
            errorFeedback.style.display = 'none';
            gameOverlay.style.display = 'none';
        }

        // Hide all feedback
        function hideAllFeedback() {
            successFeedback.style.display = 'none';
            errorFeedback.style.display = 'none';
            gameOverlay.style.display = 'none';
        }

        // Initialize the game when page loads
        document.addEventListener('DOMContentLoaded', initGame);
    </script>
</body>
</html>