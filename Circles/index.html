<!DOCTYPE html>
<html>
<head>
    <title>Circle Architect: Arc Mission</title>
    <style>
        body { text-align: center; font-family: 'Segoe UI', sans-serif; background: #1a1a2e; color: white; }
        canvas { background: #16213e; border: 3px solid #0f3460; border-radius: 50%; cursor: crosshair; }
        .ui { margin: 20px; padding: 15px; background: #0f3460; display: inline-block; border-radius: 10px; }
        button { padding: 10px 20px; font-weight: bold; cursor: pointer; background: #e94560; color: white; border: none; border-radius: 5px; }
        #feedback { font-size: 1.2rem; font-weight: bold; color: #4ecca3; }
    </style>
</head>
<body>

    <h1>⚡ Project Orbiter: Arc Power</h1>
    <p>Target Arc Length: <span id="target-ui">?</span> units</p>
    
    <canvas id="gameCanvas" width="400" height="400"></canvas>

    <div class="ui">
        <p>Current Angle: <span id="angle-ui">0</span>°</p>
        <p>Your Arc Length: <span id="calc-ui">0</span> units</p>
        <button onclick="checkAnswer()">ACTIVATE POWER</button>
        <p id="feedback"></p>
    </div>

    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        const radius = 150;
        let currentAngle = 45;
        let targetArcLength = 0;

        // Initialize Level
        function initLevel() {
            // Generate a random target arc length (using Form 2 logic: s = angle/360 * 2 * pi * r)
            const randomAngle = Math.floor(Math.random() * 180) + 30;
            targetArcLength = ((randomAngle / 360) * 2 * Math.PI * radius).toFixed(1);
            document.getElementById('target-ui').innerText = targetArcLength;
            draw();
        }

        function draw() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            const cx = canvas.width / 2;
            const cy = canvas.height / 2;

            // Draw City Boundary (Circumference)
            ctx.beginPath();
            ctx.arc(cx, cy, radius, 0, 2 * Math.PI);
            ctx.strokeStyle = '#533483';
            ctx.lineWidth = 5;
            ctx.stroke();

            // Draw Power Beam (The Arc)
            const rad = currentAngle * (Math.PI / 180);
            ctx.beginPath();
            ctx.arc(cx, cy, radius, 0, rad);
            ctx.strokeStyle = '#e94560';
            ctx.lineWidth = 10;
            ctx.lineCap = 'round';
            ctx.stroke();

            // Draw Radius lines (The Sector)
            ctx.beginPath();
            ctx.moveTo(cx, cy);
            ctx.lineTo(cx + radius, cy);
            ctx.moveTo(cx, cy);
            ctx.lineTo(cx + radius * Math.cos(rad), cy + radius * Math.sin(rad));
            ctx.strokeStyle = 'rgba(233, 69, 96, 0.3)';
            ctx.lineWidth = 2;
            ctx.stroke();
        }

        // Mouse Control to adjust angle
        canvas.addEventListener('mousemove', (e) => {
            const rect = canvas.getBoundingClientRect();
            const x = e.clientX - rect.left - canvas.width / 2;
            const y = e.clientY - rect.top - canvas.height / 2;
            let angle = Math.atan2(y, x) * (180 / Math.PI);
            if (angle < 0) angle += 360;
            
            currentAngle = angle;
            const currentArc = ((currentAngle / 360) * 2 * Math.PI * radius).toFixed(1);
            
            document.getElementById('angle-ui').innerText = Math.floor(currentAngle);
            document.getElementById('calc-ui').innerText = currentArc;
            draw();
        });

        function checkAnswer() {
            const currentArc = ((currentAngle / 360) * 2 * Math.PI * radius).toFixed(1);
            const diff = Math.abs(currentArc - targetArcLength);

            if (diff < 5) {
                document.getElementById('feedback').innerText = "✅ STABLE! Power restored.";
                setTimeout(initLevel, 2000);
            } else {
                document.getElementById('feedback').innerText = "❌ UNSTABLE! Energy Leak!";
            }
        }

        initLevel();
    </script>
</body>
</html>